# 哔哩哔哩下载播放工具


哔哩哔哩下载播放工具 BiliBli Downloader&Player

40000字源码的精致脚本

本工具用于下载和播放哔哩哔哩的番剧和站内视频，支持下载大会员专享番剧。
支持自动切P、预加载下一集、调节画质、并发下载。

仅用作学习交流

主程序：Main.cmd

播放器常用快捷键：
	← 后退
	→ 前进
	空格/P 暂停
	F 全屏/窗口
	Q 退出


使用说明：

	1.  本程序的所有正版视频获取，均模拟B站的相关界面调用官方API，基本上不存在被封IP的风险，也不会被限速；

	2.  本程序通过重定向到其它网站的相同番剧解决大会员限制问题，详情如下：
		（1）樱花动漫：主线路，其常规画质为720P，暂不可调整；
		（2）爱奇艺：备用线路，画质为720P及以上，默认解析最高画质，暂不可调整，且不可下载。

	3.  站内视频获取 兼容AV号和BV号，BV号请保留“BV”，AV号可省略“AV”；

	4.  UI会依据窗口大小自动适配，但还是建议Win7将窗口大小默认值适当调大；

	5.  部分“播放设置”的详细介绍：
		（1）预加载：打开后会在本集下载完后提前自动下载下一集，如果是补番的话建议打开此功能；
		（2）视频画质：
			① 如果没有设定的画质会自动向下推；
			② B站大多数视频的高画质要大会员，一般能下载到1080P；
		（3）并发加载数：
			① 即为最大允许同时下载多少个视频片段，用户可根据自己的网速适当调整；
			② 并不是越大越好，网速和电脑配置若跟不上只会增加失败率，而且边下边播时会相当卡；
			③ 参考值：（不计电脑配置的情况下）
			带宽	并发加载数
			<20M	1
			20~80M	2
			100M 	3
			200M	6
			300M≥	8

	7.  视频下载位置为当前目录下的Donwload文件夹，不会被自动删除，当储存空间不足时，可以考虑手动删掉部分视频以释放空间。

	8.  当前边下边播支持：哔哩哔哩的FLV（M4S暂不支持）、樱花动漫的MP4、爱奇艺的M3U8，支持播放已下载的所有格式的视频。


常见问题解决办法：

	1.  在线播放若经常出现崩溃的情况，可到“播放设置”中
		（1）将“并发加载数”降低；
		（2）将“视频画质”降低；

	2.  若开始播放后略有杂音
		可暂停1~2秒后继续播放。

	3.  若搜索不到想要的结果，请排查下列原因
		（1）B站是不是真的有这个番剧；
		（2）是否已经下架该番剧；
		（3）关键词是否准确。

	4.  视频若下载失败，请排查下列原因
		（1）哔哩哔哩没有特别特别重大的更新；
		（2）AV号/BV号是否正确，番剧是否存在；
		（3）网络连接不稳定；
		（4）网速相当慢；
		（5）大会员专属番剧无法下载。

	5.  窗口内显示不了任何字符，全是报错
		换Win10，小部分Win7可能无法兼容，Win7需要把窗口字体换为：宋体。

	6.  视频播放到一半突然卡住不动
		（1）如果视频来源为哔哩哔哩：关闭视频窗口，播放器会重新尝试打开视频，且观看进度会保存；
		（2）其它视频来源：关闭视频窗口，选集界面重新进入即可。

	7.  各种功能全部失效
		该版本最后编辑在 2021/2/23。


# 更新日志：
2021/2/23

	1. B站API更新，影响使用，于是更新。

2021/2/21

	1.  B站CDN更新，影响使用，于是更新。

2021/2/11

	1.  樱花动漫换域名了，故稍作改动；

	2.  部分港澳台地区番剧暂不支持，也没时间跟进，以后看情况；

	3.  播放器已经可以支持全部边下边播，有空更新上去。

2020/4/9

	1.  修复文件名特殊字符导致无法下载的问题。

2020/4/8

	1.  修复搜索加速判定错误。（影响使用级别的BUG）


2020/4/7

	1.  提升程序兼容性，使其在苛刻的环境中能够正常使用；

	2.  视频下载部分由curl改为aria2c
		（1）降低下载的失败率；
		（2）支持断点续传；
		（3）支持磁盘缓存，提升下载稳定性和速率；
		（4）支持重试，免去了批处理的部分繁杂的源码。

	3.  提升播放器稳定性，降低其崩溃概率；

	4.  提升视频解析的兼容性，解决部分链接解析失败的问题；

	5.  解决大会员限制问题，可能仍有极少数视频暂时无法观看；

	6.  现在程序会通过解析本地的临时缓存加速打开页面，极大的提高了程序效率；

	7.  解决部分可选功能无法使用的问题；

	8.  解决本地播放的一个问题。

